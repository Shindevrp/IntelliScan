{% extends 'layout.html' %}

{% block head %}
    <title>AI-Powered Network Scanner - Dashboard</title>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8">
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Network Scanner</h5>
                <div>
                    <span class="badge bg-info" id="scan-status">Ready</span>
                </div>
            </div>
            <div class="card-body">
                <form id="scan-form" class="mb-4">
                    <div class="mb-3">
                        <label for="targets" class="form-label">Target(s)</label>
                        <input type="text" class="form-control" id="targets" placeholder="IP address, domain, or range (e.g., 192.168.1.1-10, example.com)">
                        <div class="form-text">Enter IP addresses, domains, or ranges separated by commas</div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="scan-type" class="form-label">Scan Type</label>
                            <select class="form-select" id="scan-type">
                                <option value="quick">Quick Scan</option>
                                <option value="standard" selected>Standard Scan</option>
                                <option value="comprehensive">Comprehensive Scan</option>
                                <option value="custom">Custom Scan</option>
                            </select>
                        </div>
                        <div class="col-md-6 custom-ports-container d-none">
                            <label for="custom-ports" class="form-label">Custom Ports</label>
                            <input type="text" class="form-control" id="custom-ports" placeholder="22,80,443,3389">
                            <div class="form-text">Enter ports separated by commas</div>
                        </div>
                    </div>

                    <div class="d-flex justify-content-between">
                        <button type="submit" class="btn btn-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search me-1"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                            Start Scan
                        </button>
                        <div>
                            <button type="button" class="btn btn-outline-info me-2" id="voice-command-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mic"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                                Voice Command
                            </button>
                            <button type="button" class="btn btn-outline-secondary" id="text-command-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-square"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                                Text Prompt
                            </button>
                        </div>
                    </div>
                </form>

                <!-- Progress bar (hidden by default) -->
                <div id="scan-progress-container" class="mb-4 d-none">
                    <label for="scan-progress" class="form-label">Scan Progress</label>
                    <div class="progress" style="height: 20px">
                        <div id="scan-progress" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                    </div>
                    <div class="d-flex justify-content-between mt-1">
                        <small id="progress-text">0%</small>
                        <small id="scan-time">Time: 0s</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Live Results Card -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Live Results</h5>
            </div>
            <div class="card-body">
                <div class="alert alert-info" id="live-results-placeholder">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-info me-2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                    Start a scan to see live results
                </div>
                <div id="live-results" class="d-none">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Target</th>
                                    <th>Port</th>
                                    <th>Status</th>
                                    <th>Service</th>
                                </tr>
                            </thead>
                            <tbody id="results-table-body">
                                <!-- Results will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="card-footer text-center">
                <button type="button" class="btn btn-outline-primary d-none" id="view-full-results-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link me-1"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                    View Full Results
                </button>
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <!-- AI Agent Card -->
        <div class="card mb-4">
            <div class="card-header bg-info bg-opacity-25">
                <div class="d-flex align-items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-cpu me-2"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line></svg>
                    <h5 class="mb-0">AI Agent</h5>
                </div>
            </div>
            <div class="card-body">
                <div id="ai-agent-placeholder" class="text-center py-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-cpu mb-3"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line></svg>
                    <p class="text-muted">AI agent is ready and waiting for a scan to start.</p>
                </div>
                <div id="ai-insights" class="d-none">
                    <div class="mb-3">
                        <h6 class="border-bottom pb-2">Scan Insights</h6>
                        <ul class="list-group list-group-flush" id="insights-list">
                            <!-- Insights will be inserted here -->
                        </ul>
                    </div>
                    <div id="anomalies-container" class="d-none">
                        <h6 class="border-bottom pb-2 text-warning">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-triangle me-1"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                            Anomalies Detected
                        </h6>
                        <ul class="list-group list-group-flush" id="anomalies-list">
                            <!-- Anomalies will be inserted here -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Scans Card -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Recent Scans</h5>
            </div>
            <div class="card-body">
                <div id="recent-scans-placeholder" class="text-center py-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock mb-3"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                    <p class="text-muted">No recent scans found.</p>
                </div>
                <ul class="list-group list-group-flush" id="recent-scans-list">
                    <!-- Recent scans will be inserted here -->
                </ul>
            </div>
        </div>

        <!-- Text Command Modal -->
        <div class="modal fade" id="textCommandModal" tabindex="-1" aria-labelledby="textCommandModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="textCommandModalLabel">Enter Text Command</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="text-command" class="form-label">Describe what you want to scan</label>
                            <textarea class="form-control" id="text-command" rows="3" placeholder="Example: Scan my local network for web servers"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="process-text-command">Process Command</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Voice Command Modal -->
        <div class="modal fade" id="voiceCommandModal" tabindex="-1" aria-labelledby="voiceCommandModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="voiceCommandModalLabel">Voice Command</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="text-center">
                            <div id="voice-recording-status" class="mb-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mic mb-3"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                                <p>Click the button below to start recording</p>
                            </div>
                            <div class="d-none" id="voice-processing">
                                <div class="spinner-border text-primary mb-3" role="status">
                                    <span class="visually-hidden">Processing...</span>
                                </div>
                                <p>Processing your command...</p>
                            </div>
                            <div class="d-none" id="voice-result">
                                <div class="alert alert-success mb-3">Command processed successfully</div>
                                <div class="mb-3">
                                    <strong>Recognized text:</strong>
                                    <p id="recognized-text" class="border-bottom pb-2"></p>
                                </div>
                                <div>
                                    <strong>Interpreted as:</strong>
                                    <ul class="list-group list-group-flush" id="interpreted-command">
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer justify-content-center">
                        <button type="button" class="btn btn-primary btn-lg rounded-circle p-3" id="start-recording">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mic"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                        </button>
                        <button type="button" class="btn btn-danger btn-lg rounded-circle p-3 d-none" id="stop-recording">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-square"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>
                        </button>
                        <button type="button" class="btn btn-success d-none" id="apply-voice-command" data-bs-dismiss="modal">Apply Command</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
<script src="{{ url_for('static', filename='js/voice_commands.js') }}"></script>
<script src="{{ url_for('static', filename='js/scanner_interface.js') }}"></script>
{% endblock %}
